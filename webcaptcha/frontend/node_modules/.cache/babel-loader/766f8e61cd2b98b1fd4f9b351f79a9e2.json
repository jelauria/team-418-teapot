{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = __importStar(require(\"react\"));\n\nvar tooltip_1 = __importDefault(require(\"./tooltip\"));\n\nvar ActionTooltip = function (_super) {\n  __extends(ActionTooltip, _super);\n\n  function ActionTooltip(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {\n      tooltipContent: null,\n      taskIsRunning: false\n    };\n    return _this;\n  }\n\n  ActionTooltip.prototype.componentWillUnmount = function () {\n    this.clearTimer();\n  };\n\n  ActionTooltip.prototype.clearTimer = function () {\n    if (this.timer) {\n      clearTimeout(this.timer);\n    }\n  };\n\n  ActionTooltip.prototype.resetState = function () {\n    if (!this.state.taskIsRunning) {\n      this.clearTimer();\n      this.setState({\n        tooltipContent: null\n      });\n    }\n  };\n\n  ActionTooltip.prototype.preprocessContent = function () {\n    var rawContent = this.props.content;\n    return typeof rawContent === 'string' ? {\n      default: rawContent\n    } : rawContent;\n  };\n\n  ActionTooltip.prototype.setTooltipContent = function (newContent, additionalState) {\n    var _this = this;\n\n    if (additionalState === void 0) {\n      additionalState = {};\n    }\n\n    var content = this.preprocessContent();\n    this.setState(__assign({\n      tooltipContent: newContent\n    }, additionalState));\n    this.clearTimer();\n\n    if (newContent === content.default) {\n      return;\n    }\n\n    var resetDelay = this.props.resetDelay;\n    this.timer = window.setTimeout(function () {\n      return _this.setState({\n        tooltipContent: content.default\n      });\n    }, resetDelay);\n  };\n\n  ActionTooltip.prototype.processAction = function () {\n    var _this = this;\n\n    var _a = this.props,\n        children = _a.children,\n        resetDelay = _a.resetDelay;\n    var button = children;\n    var content = this.preprocessContent();\n\n    if (!button) {\n      return null;\n    }\n\n    var newHandler = function (event) {\n      _this.resetState();\n\n      if (content.loading) {\n        _this.setTooltipContent(content.loading, {\n          taskIsRunning: true\n        });\n      } else {\n        _this.setState({\n          taskIsRunning: true\n        });\n      }\n\n      Promise.resolve(button.props.onClick(event)).then(function (result) {\n        return _this.setTooltipContent(content.success || content.default, {\n          taskIsRunning: false\n        });\n      }).catch(function () {\n        return _this.setTooltipContent(content.error || 'Something did not work', {\n          taskIsRunning: false\n        });\n      });\n    };\n\n    var onMouseLeave = function (ev) {\n      if (button.props.onMouseLeave) {\n        button.props.onMouseLeave(ev);\n      }\n\n      _this.resetState();\n    };\n\n    return React.cloneElement(button, {\n      onClick: newHandler,\n      appearance: 'link',\n      onMouseLeave: onMouseLeave\n    });\n  };\n\n  ActionTooltip.prototype.render = function () {\n    var tooltipContent = this.state.tooltipContent;\n    var content = this.preprocessContent();\n    var children = this.processAction();\n    return React.createElement(tooltip_1.default, {\n      content: tooltipContent ? tooltipContent : content.default,\n      children: children\n    });\n  };\n\n  ActionTooltip.defaultProps = {\n    resetDelay: 5000\n  };\n  return ActionTooltip;\n}(React.Component);\n\nexports.default = ActionTooltip;","map":{"version":3,"sources":["../../../../../atoms/tooltip/action.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __importStar(require(\"react\"));\nvar tooltip_1 = __importDefault(require(\"./tooltip\"));\nvar ActionTooltip = (function (_super) {\n    __extends(ActionTooltip, _super);\n    function ActionTooltip(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = { tooltipContent: null, taskIsRunning: false };\n        return _this;\n    }\n    ActionTooltip.prototype.componentWillUnmount = function () {\n        this.clearTimer();\n    };\n    ActionTooltip.prototype.clearTimer = function () {\n        if (this.timer) {\n            clearTimeout(this.timer);\n        }\n    };\n    ActionTooltip.prototype.resetState = function () {\n        if (!this.state.taskIsRunning) {\n            this.clearTimer();\n            this.setState({ tooltipContent: null });\n        }\n    };\n    ActionTooltip.prototype.preprocessContent = function () {\n        var rawContent = this.props.content;\n        return typeof rawContent === 'string' ? { default: rawContent } : rawContent;\n    };\n    ActionTooltip.prototype.setTooltipContent = function (newContent, additionalState) {\n        var _this = this;\n        if (additionalState === void 0) { additionalState = {}; }\n        var content = this.preprocessContent();\n        this.setState(__assign({ tooltipContent: newContent }, additionalState));\n        this.clearTimer();\n        if (newContent === content.default) {\n            return;\n        }\n        var resetDelay = this.props.resetDelay;\n        this.timer = window.setTimeout(function () { return _this.setState({ tooltipContent: content.default }); }, resetDelay);\n    };\n    ActionTooltip.prototype.processAction = function () {\n        var _this = this;\n        var _a = this.props, children = _a.children, resetDelay = _a.resetDelay;\n        var button = children;\n        var content = this.preprocessContent();\n        if (!button) {\n            return null;\n        }\n        var newHandler = function (event) {\n            _this.resetState();\n            if (content.loading) {\n                _this.setTooltipContent(content.loading, { taskIsRunning: true });\n            }\n            else {\n                _this.setState({ taskIsRunning: true });\n            }\n            Promise.resolve(button.props.onClick(event))\n                .then(function (result) {\n                return _this.setTooltipContent(content.success || content.default, { taskIsRunning: false });\n            })\n                .catch(function () {\n                return _this.setTooltipContent(content.error || 'Something did not work', {\n                    taskIsRunning: false\n                });\n            });\n        };\n        var onMouseLeave = function (ev) {\n            if (button.props.onMouseLeave) {\n                button.props.onMouseLeave(ev);\n            }\n            _this.resetState();\n        };\n        return React.cloneElement(button, {\n            onClick: newHandler,\n            appearance: 'link',\n            onMouseLeave: onMouseLeave\n        });\n    };\n    ActionTooltip.prototype.render = function () {\n        var tooltipContent = this.state.tooltipContent;\n        var content = this.preprocessContent();\n        var children = this.processAction();\n        return (React.createElement(tooltip_1.default, { content: tooltipContent ? tooltipContent : content.default, children: children }));\n    };\n    ActionTooltip.defaultProps = {\n        resetDelay: 5000\n    };\n    return ActionTooltip;\n}(React.Component));\nexports.default = ActionTooltip;\n//# sourceMappingURL=action.js.map"]},"metadata":{},"sourceType":"script"}